<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¡ˆä¾‹å››ï¼šææ‡¼çš„ç¸½å’Œ (æ¸…æ™°ä¿®å¾©ç‰ˆ)</title>
    <style>
        /* --- å…¨åŸŸè¨­å®š --- */
        :root {
            --bg-color: #1a1a1a;
            --left-bg: #ffffff;
            --right-bg: #2c3e50;
            --text-main: #2c3e50;
            --text-light: #ffffff;
            --highlight: #e74c3c;
            --btn-blue: #c0392b;
            --nurse-bg: #d4efdf;
            --npc-bg: #f2f3f4;
            --jit-bg: rgba(243, 156, 18, 0.25);
            --jit-border: #d35400;
        }

        body { font-family: "Microsoft JhengHei", sans-serif; background-color: var(--bg-color); margin: 0; height: 100vh; overflow: hidden; display: flex; justify-content: center; align-items: center; -webkit-font-smoothing: antialiased; }
        
        #stage-container { width: 100vw; height: 100vh; background-color: #fff; display: flex; flex-direction: row; position: relative; }
        #story-panel { width: 60%; background-color: var(--left-bg); display: flex; flex-direction: column; padding: 20px; border-right: 5px solid #bdc3c7; position: relative; }
        #mood-badge { position: absolute; top: 20px; left: 20px; background-color: #34495e; color: white; padding: 10px 30px; border-radius: 50px; font-size: 1.5rem; font-weight: bold; z-index: 5; }
        
        #vocab-btn { position: absolute; top: 20px; right: 20px; background-color: var(--highlight); color: #fff; border: 3px solid #fff; padding: 10px 20px; border-radius: 10px; font-size: 1.2rem; font-weight: bold; cursor: pointer; z-index: 100; box-shadow: 0 4px 5px rgba(0,0,0,0.3); transition: transform 0.2s; }
        #vocab-btn:hover { transform: scale(1.05); }

        #dialogue-box { flex: 1; overflow-y: auto; padding: 80px 20px 20px 20px; display: flex; flex-direction: column; gap: 25px; scroll-behavior: smooth; }
        .msg { max-width: 90%; padding: 25px 35px; border-radius: 20px; font-size: 2rem; line-height: 1.6; animation: fadeIn 0.5s ease; position: relative; }
        .msg-npc { align-self: flex-start; background-color: var(--npc-bg); border-left: 10px solid #c0392b; color: var(--text-main); }
        .msg-player { align-self: flex-end; background-color: var(--nurse-bg); border-right: 10px solid #27ae60; color: #0e6655; }
        .msg strong { display: block; font-size: 1.6rem; margin-bottom: 10px; opacity: 0.8; }

        /* JIT æ¨£å¼ä¿®å¾©ï¼šè¢å…‰ç­†é¢¨æ ¼ï¼Œç¢ºä¿æ¸…æ™° */
        .jit-term {
            color: var(--text-main);
            background-color: var(--jit-bg);
            border-bottom: 2px solid var(--jit-border); /* å¯¦ç·šç¢ºä¿ä¸æ¨¡ç³Š */
            padding: 2px 5px;
            border-radius: 4px;
            cursor: help;
            transition: all 0.2s;
            display: inline-block;
        }
        .jit-term:hover { background-color: rgba(243, 156, 18, 0.5); color: #000; }

        #global-tooltip { position: fixed; display: none; background-color: #34495e; color: #fff; padding: 20px; border-radius: 12px; max-width: 350px; font-size: 1.4rem; line-height: 1.5; box-shadow: 0 10px 30px rgba(0,0,0,0.5); z-index: 9999; border: 2px solid #fff; pointer-events: none; opacity: 0; transition: opacity 0.2s ease; }
        #global-tooltip strong { display: block; color: #f1c40f; font-size: 1.6rem; margin-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 5px; }

        #analysis-panel { width: 40%; background-color: var(--right-bg); color: var(--text-light); display: flex; flex-direction: column; padding: 30px; overflow-y: auto; }
        .section-box { margin-bottom: 25px; background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; border-left: 6px solid var(--highlight); flex-shrink: 0; }
        .section-title { font-size: 1.4rem; color: var(--highlight); font-weight: bold; margin-bottom: 10px; text-transform: uppercase; }
        .section-content { font-size: 1.5rem; line-height: 1.6; color: #fff; }
        .ui-hint { text-align: center; color: rgba(255,255,255,0.7); font-size: 1rem; margin-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 10px; flex-shrink: 0; }
        #controls-area { margin-top: auto; display: flex; flex-direction: column; gap: 20px; padding-bottom: 50px; flex-shrink: 0; }
        .btn { background-color: var(--btn-blue); color: white; border: 2px solid rgba(255,255,255,0.2); padding: 25px; font-size: 1.8rem; border-radius: 15px; cursor: pointer; text-align: left; }
        .btn:hover { background-color: #922b21; transform: translateY(-2px); }
        #feedback-box { display: none; background: #27ae60; color: white; padding: 20px; border-radius: 10px; font-size: 1.6rem; margin-top: 20px; margin-bottom: 20px; text-align: center; border: 3px solid white; flex-shrink: 0; }
        
        #vocab-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); z-index: 9999; justify-content: center; align-items: center; }
        #vocab-content { background-color: #fff; width: 80%; max-width: 900px; max-height: 85vh; overflow-y: auto; border-radius: 20px; padding: 40px; position: relative; box-shadow: 0 0 50px rgba(0,0,0,0.5); }
        #vocab-content h2 { color: #2c3e50; border-bottom: 3px solid var(--highlight); padding-bottom: 10px; }
        .vocab-item { margin-bottom: 30px; border-bottom: 1px solid #eee; padding-bottom: 20px; }
        .vocab-term { font-size: 1.8rem; font-weight: bold; color: #2980b9; margin-bottom: 5px; }
        .vocab-def { font-size: 1.5rem; color: #555; line-height: 1.6; }
        .close-btn { position: absolute; top: 20px; right: 20px; font-size: 3rem; color: #999; cursor: pointer; line-height: 1; }

        @media (max-width: 1024px) or (orientation: portrait) {
            body { overflow-y: auto; height: auto; }
            #stage-container { flex-direction: column; height: auto; width: 100%; }
            #story-panel { width: 100%; height: 50vh; border-right: none; border-bottom: 5px solid #bdc3c7; }
            #analysis-panel { width: 100%; min-height: 50vh; padding: 20px; padding-bottom: 80px; }
            .msg { font-size: 1.3rem; padding: 15px; } .btn { font-size: 1.4rem; padding: 15px; }
            #global-tooltip { max-width: 80%; font-size: 1.2rem; bottom: 20px !important; top: auto !important; left: 50% !important; transform: translateX(-50%); }
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
<div id="global-tooltip"></div>
<div id="vocab-modal">
    <div id="vocab-content"><span class="close-btn" onclick="toggleVocab()">Ã—</span><h2>ğŸ“– å°ˆæ¥­è©å½™é€ŸæŸ¥</h2>
        <div class="vocab-item"><div class="vocab-term">é†«ç™‚æš´åŠ› (Medical Violence)</div><div class="vocab-def">å°é†«è­·äººå“¡é€²è¡Œè¨€èªä¾®è¾±ã€å¨è„…æˆ–è‚¢é«”æ”»æ“Šï¼Œæ³•å¾‹æ¡å–ã€Œé›¶å®¹å¿ã€åŸå‰‡ã€‚</div></div>
        <div class="vocab-item"><div class="vocab-term">ç…§è­·ç¾©å‹™ (Duty to Care)</div><div class="vocab-def">æä¾›ç…§è­·æ˜¯è·è²¬ï¼Œä½†ç•¶è‡ªèº«å®‰å…¨å—å¨è„…æ™‚ï¼Œéç„¡é™ä¸Šç¶±ã€‚</div></div>
        <div class="vocab-item"><div class="vocab-term">æ±ºç­–èƒ½åŠ› (Decision-making Capacity)</div><div class="vocab-def">é…’é†‰æˆ–è…¦å‚·å¯èƒ½å°è‡´æš«æ™‚æ€§å¤±èƒ½ï¼Œç„¡æ³•è¡Œä½¿è‡ªä¸»æ¬Šã€‚</div></div>
        <div class="vocab-item"><div class="vocab-term">é™éšæŠ€å·§ (De-escalation)</div>
            <div class="vocab-def">
                é€éèªè¨€å’Œéèªè¨€ç­–ç•¥é™ä½æƒ…ç·’å¼µåŠ›ã€‚<br>
                <strong>å…·é«”è¡Œå‹•ï¼š</strong><br>
                - ä¿æŒå®‰å…¨è·é›¢ (2å€æ‰‹è‡‚é•·)<br>
                - èªæ°£æº«å’Œã€èªé€Ÿæ”¾æ…¢<br>
                - é¿å…ç›´è¦–çœ¼ç› (æ¸›å°‘æŒ‘é‡æ„Ÿ)<br>
                - é–‹æ”¾å¼è‚¢é«”èªè¨€ (æ‰‹æŒæ”¤é–‹)
            </div>
        </div>
        <div class="vocab-item"><div class="vocab-term">é†«ç™‚é¿é›£ (Withdrawal of Care)</div><div class="vocab-def">åœ¨æ¥µç«¯æš´åŠ›å¨è„…ä¸‹ï¼Œæš«æ™‚æ’¤é›¢ä»¥æ±‚è‡ªä¿ï¼Œä¸é•åå€«ç†ã€‚</div></div>
    </div>
</div>
<div id="stage-container">
    <button id="vocab-btn" onclick="toggleVocab()">ğŸ“– çŸ¥è­˜é€ŸæŸ¥</button>
    <div id="story-panel"><div id="mood-badge">Segment 1</div><div id="dialogue-box"></div></div>
    <div id="analysis-panel">
        <div class="ui-hint">ğŸ’¡ æç¤ºï¼šé»æ“Š <span class="jit-term" data-def="é€™å°±æ˜¯ JITï¼æ¸…æ¥šã€ä¸æ¨¡ç³Šã€‚">æ©˜è‰²è¢å…‰å­—</span> å¯å³æ™‚æŸ¥çœ‹å®šç¾©</div>
        <div class="section-box"><div class="section-title">ğŸ¯ Objectives</div><div class="section-content" id="obj-text"></div></div>
        <div class="section-box"><div class="section-title">â“ Question</div><div class="section-content" id="question-text"></div></div>
        <div class="section-box"><div class="section-title">ğŸ“ Task</div><div class="section-content" id="task-text"></div></div>
        <div id="feedback-box"></div><div id="controls-area"></div>
    </div>
</div>
<script>
    const chatBox = document.getElementById('dialogue-box'); const controls = document.getElementById('controls-area'); const moodBadge = document.getElementById('mood-badge'); const objText = document.getElementById('obj-text'); const qText = document.getElementById('question-text'); const taskText = document.getElementById('task-text'); const feedbackBox = document.getElementById('feedback-box'); const vocabModal = document.getElementById('vocab-modal'); const tooltip = document.getElementById('global-tooltip');
    function toggleVocab() { vocabModal.style.display = vocabModal.style.display === 'flex' ? 'none' : 'flex'; }
    function enableJIT() { const terms = document.querySelectorAll('.jit-term'); terms.forEach(term => { term.addEventListener('mouseenter', (e) => showTooltip(e, term)); term.addEventListener('mousemove', (e) => moveTooltip(e)); term.addEventListener('mouseleave', hideTooltip); term.addEventListener('click', (e) => showTooltip(e, term)); }); }
    function showTooltip(e, term) { const def = term.getAttribute('data-def'); const title = term.innerText; tooltip.innerHTML = `<strong>${title}</strong>${def}`; tooltip.style.display = 'block'; requestAnimationFrame(() => { tooltip.style.opacity = '1'; moveTooltip(e); }); }
    function moveTooltip(e) { const w = window.innerWidth; const h = window.innerHeight; let x = e.clientX + 15; let y = e.clientY + 15; if (x + 300 > w) x = e.clientX - 320; if (y + 150 > h) y = e.clientY - 160; if(w > 1024) { tooltip.style.left = x + 'px'; tooltip.style.top = y + 'px'; } }
    function hideTooltip() { tooltip.style.opacity = '0'; setTimeout(() => { tooltip.style.display = 'none'; }, 200); }

    const scenes = {
        start: { segment: "Segment 1: å€«ç†æ•æ„Ÿåº¦", objectives: "è¾¨è­˜å€«ç†è¡çª", questions: "ç•¶ç—…äººå…·æœ‰æ”»æ“Šæ€§æ™‚ï¼Œé¦–è¦è·è²¬æ˜¯ä»€éº¼ï¼Ÿ", tasks: "è«‹åˆ†æï¼šè­·ç†å¸«é¢è‡¨å“ªå…©ç¨®ç¾©å‹™çš„æ‹‰æ‰¯ï¼Ÿ", messages: [{ role: "system", text: "ã€æƒ…å¢ƒã€‘é…’é†‰ç—…äººé ­éƒ¨æµè¡€ï¼Œæ‚¨è¦æ›è—¥ã€‚" }, { role: "npc", name: "ç—…äºº", text: "(æ¨é–‹æ‚¨) æ»¾é–‹ï¼åˆ¥ç¢°æˆ‘ï¼(ä½œå‹¢æ‰“äºº)" }, { role: "player", text: "ï¼ˆä»–éœ€è¦æ²»ç™‚ï¼Œä½†ä»–æœ‰æ”»æ“Šæ€§...ï¼‰" }], choices: [{ text: "A. <span class='jit-term' data-def='ç…§è­·ç¾©å‹™ (Duty to Care)ï¼šé†«ç™‚äººå“¡æœ‰è²¬ä»»æä¾›ç…§è­·ã€‚'>ç…§è­·ç¾©å‹™</span> vs. <span class='jit-term' data-def='è‡ªæˆ‘ä¿è­· (Non-maleficence)ï¼šé¿å…è‡ªå·±é­å—æš´åŠ›å‚·å®³æ˜¯åŸ·æ¥­å‰æã€‚'>è‡ªæˆ‘ä¿è­·</span>", next: "correct_s1" }, { text: "B. å…¬å¹³åŸå‰‡ vs. èª å¯¦åŸå‰‡", next: "wrong_s1" }] },
        wrong_s1: { feedback: "âš ï¸ æç¤ºï¼šè¡çªé»åœ¨æ–¼ã€Œæƒ³æ•‘ä»–ã€èˆ‡ã€Œæ€•å—å‚·ã€ä¹‹é–“ã€‚", repeat_scene: "start" },
        correct_s1: { feedback: "ğŸ‰ æ­£ç¢ºï¼åœ¨æš´åŠ›ç¾å ´ï¼Œå®‰å…¨æ°¸é æ˜¯ç¬¬ä¸€å„ªå…ˆã€‚", next_scene: "seg2_intro" },
        seg2_intro: { segment: "Segment 2: å€«ç†æ¨ç†", objectives: "è©•ä¼°æ±ºç­–èƒ½åŠ›", questions: "ç—…äººæ‹’çµ•æ²»ç™‚ï¼Œæ‡‰å°Šé‡å—ï¼Ÿ", tasks: "è©•ä¼°ç—…äººçš„ã€Œ<span class='jit-term' data-def='æ±ºç­–èƒ½åŠ› (Capacity)ï¼šé…’é†‰æˆ–è…¦å‚·å¯èƒ½å°è‡´æš«æ™‚å¤±èƒ½ã€‚'>æ±ºç­–èƒ½åŠ›</span>ã€èˆ‡é¢¨éšªã€‚", messages: [{ role: "system", text: "ã€æ¼”è®Šã€‘ç—…äººå¤§å¼å¤§å«ï¼Œæ‹’çµ•ç¸«åˆï¼Œå‡ºè¡€ä¸æ­¢ã€‚" }, { role: "npc", name: "ç—…äºº", text: "æˆ‘è¦å›å®¶ï¼èª°æ””æˆ‘æèª°ï¼" }], choices: [{ text: "A. å°Šé‡è‡ªä¸»ï¼šç°½ AAD è®“ä»–èµ°ã€‚", next: "wrong_s2" }, { text: "B. è©•ä¼°å¤±èƒ½ï¼šä»–ç¼ºä¹æ±ºç­–åŠ›ä¸”å±éšªï¼Œä¸èƒ½æ”¾è¡Œã€‚", next: "correct_s2" }] },
        wrong_s2: { feedback: "âš ï¸ é·¹æ¶ï¼šé…’é†‰ä¸”é ­éƒ¨å¤–å‚·è€…å¯èƒ½ç„¡æ³•ç†æ€§åˆ¤æ–·ï¼Œæ”¾ä»»é›¢é–‹ææœ‰é†«ç™‚ç–å¤±ã€‚", repeat_scene: "seg2_intro" },
        correct_s2: { feedback: "ğŸ‰ åˆ†ææ­£ç¢ºï¼ç—…äººæš«æ™‚å–ªå¤±æ±ºç­–èƒ½åŠ›ï¼Œä¸é©ç”¨ä¸€èˆ¬è‡ªä¸»åŸå‰‡ã€‚", next_scene: "seg3_intro" },
        seg3_intro: { segment: "Segment 3: å°ˆæ¥­è¡Œå‹•", objectives: "åŸ·è¡Œå®‰å…¨é˜²è­·", questions: "é¢å°æš´åŠ›ï¼Œè©²æ¡å–ä»€éº¼ç­–ç•¥ï¼Ÿ", tasks: "é¸æ“‡æ­£ç¢ºçš„æ‡‰å°é †åºã€‚", messages: [{ role: "system", text: "ã€å±æ©Ÿã€‘ç—…äººèˆ‰èµ·é»æ»´æ¶æ®èˆï¼Œæ­¥æ­¥é€²é€¼ã€‚" }], choices: [{ text: "A. ã€ç¡¬ç¢°ç¡¬ã€‘å¤§è²å–æ–¥ï¼šã€Œå…ˆç”Ÿå†·éœï¼ã€", next: "action_bad" }, { text: "B. ã€å®‰å…¨æ’¤é›¢ã€‘ä¿æŒè·é›¢ï¼Œä½¿ç”¨<span class='jit-term' data-def='é™éšæŠ€å·§ (De-escalation)ï¼šæº«å’Œèªæ°£ï¼Œä¿æŒå®‰å…¨è·é›¢ï¼Œçµ¦äºˆç©ºé–“ã€‚'>é™éšæŠ€å·§</span>ï¼ŒåŒæ™‚æ±‚åŠ©ã€‚", next: "action_good" }] },
        action_bad: { segment: "Segment 3: çµæœ", objectives: "åæ€", questions: "ç‚ºä½•è¡çªå‡ç´šï¼Ÿ", tasks: "æª¢è¨ï¼šæ¬Šå¨å¼å–æ–¥åè€Œæœƒæ¿€æ€’å¤±æ§çš„ç—…äººã€‚", messages: [{ role: "npc", name: "ç—…äºº", text: "å¦³æ•¢å…‡æˆ‘ï¼Ÿï¼(æ®èˆé»æ»´æ¶)" }, { role: "system", text: "âŒ çµæœï¼šè­·ç†å¸«å—å‚·ï¼Œå ´é¢å¤±æ§ã€‚" }], choices: [{ text: "å†è©¦ä¸€æ¬¡", next: "seg3_intro" }] },
        action_good: { segment: "Segment 3: ç¸½çµ", objectives: "å®Œæˆ", questions: "å®‰å…¨æ˜¯åŸ·æ¥­çš„å‰æã€‚", tasks: "æ­å–œå®Œæˆæ¼”ç·´ã€‚", messages: [{ role: "npc", name: "è­¦è¡›", text: "(è­¦è¡›è¶•åˆ°) è­·ç†å¸«ï¼Œä½ å€‘å…ˆé€€å¾Œã€‚" }, { role: "system", text: "âœ¨ æˆåŠŸï¼šæ‚¨å„ªå…ˆç¢ºä¿äº†è‡ªèº«å®‰å…¨(<span class='jit-term' data-def='é†«ç™‚é¿é›£ (Withdrawal of Care)ï¼šæ¥µç«¯å¨è„…ä¸‹æš«æ™‚æ’¤é›¢ã€‚'>é†«ç™‚é¿é›£</span>)ï¼Œä¸¦å•Ÿå‹•æ±‚åŠ©ã€‚" }], choices: [{ text: "é€²å…¥åæ€éšæ®µ", next: "seg4_intro" }] },
        seg4_intro: { segment: "Segment 4: åæ€èˆ‡è©•å€¼", objectives: "è™•ç†é“å¾·æ®˜é¤˜", questions: "æ’¤é›¢å¾Œï¼Œæ‚¨æ˜¯å¦æ„Ÿåˆ°å…§ç–šï¼Ÿ", tasks: "è«‹é¢å°æ‚¨çš„æƒ…ç·’ï¼Œä¸¦èªè­˜ã€Œé“å¾·æ®˜é¤˜ã€ã€‚", messages: [{ role: "player", text: "ï¼ˆé›–ç„¶æˆ‘æ²’å—å‚·ï¼Œä½†çœ‹è‘—ç—…äººè¢«å£“åˆ¶æµè¡€ï¼Œæˆ‘å¿ƒè£¡é‚„æ˜¯æ€ªæ€ªçš„...ï¼‰" }], choices: [{ text: "A. è‡ªæˆ‘è²¬å‚™ï¼šæˆ‘è¦ºå¾—è‡ªå·±å¾ˆå¤±æ•—ï¼Œæ²’æœ‰ç›¡åˆ°è­·ç†è²¬ä»»ã€‚", next: "reflect_growth" }, { text: "B. å°ˆæ¥­èª¿é©ï¼šæˆ‘çŸ¥é“é€™æ˜¯ç‚ºäº†å®‰å…¨å¿…é ˆåšçš„ï¼Œæˆ‘å·²ç¶“ç›¡åŠ›äº†ã€‚", next: "reflect_success" }] },
        reflect_growth: { feedback: "ğŸŒ± é€™æ˜¯æ­£å¸¸çš„ã€Œé“å¾·æ®˜é¤˜ã€æ„Ÿå—ã€‚è«‹è¨˜ä½ï¼Œç…§é¡§å¥½è‡ªå·±æ‰èƒ½ç…§é¡§ç—…äººã€‚æ‚¨åšå¾—å¾ˆå¥½ã€‚", next_scene: "start", restart: true },
        reflect_success: { feedback: "ğŸŒŸ å¾ˆå¥½çš„å¿ƒç†ç´ è³ªï¼ç†è§£ã€Œå®‰å…¨å‰æã€æ˜¯å°ˆæ¥­çš„ä¸€éƒ¨åˆ†ã€‚æ­å–œå®Œæˆæ¼”ç·´ï¼", next_scene: "start", restart: true }
    };
    function renderScene(sceneId) { const scene = scenes[sceneId]; if (scene.feedback) { feedbackBox.style.display = 'block'; feedbackBox.style.backgroundColor = scene.next_scene ? '#27ae60' : '#e67e22'; feedbackBox.innerHTML = scene.feedback; controls.innerHTML = ''; const btn = document.createElement('button'); btn.className = 'btn'; btn.innerText = scene.restart ? "é‡æ–°é–‹å§‹ â†»" : (scene.repeat_scene ? "ğŸ”™ è¿”å›é‡é¸" : "ä¸‹ä¸€éšæ®µ â”"); btn.onclick = () => { feedbackBox.style.display = 'none'; renderScene(scene.next_scene || scene.repeat_scene); }; controls.appendChild(btn); return; } moodBadge.innerText = scene.segment; objText.innerHTML = scene.objectives; qText.innerHTML = scene.questions; taskText.innerHTML = scene.tasks; controls.innerHTML = ''; chatBox.innerHTML = ''; let delay = 0; scene.messages.forEach((msg, index) => { setTimeout(() => { const div = document.createElement('div'); div.className = msg.role === 'system' ? 'msg msg-player' : (msg.role === 'npc' ? 'msg msg-npc' : 'msg msg-player'); if(msg.role === 'system') { div.style.backgroundColor = '#fff3cd'; div.style.color = '#856404'; div.style.border = 'none'; } div.innerHTML = (msg.role === 'npc' ? `<strong>${msg.name}</strong>` : '') + msg.text; chatBox.appendChild(div); chatBox.scrollTop = chatBox.scrollHeight; enableJIT(); if (index === scene.messages.length - 1) { scene.choices.forEach(c => { const btn = document.createElement('button'); btn.className = 'btn'; btn.innerHTML = c.text; btn.onclick = () => renderScene(c.next); controls.appendChild(btn); }); setTimeout(enableJIT, 100); } }, delay); delay += 800; }); }
    renderScene('start');
</script>
</body>
</html>